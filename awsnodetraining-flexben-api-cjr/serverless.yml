org: jaddielorzano
service: awsnodetraining-cjr

frameworkVersion: '3'

provider:
  name: aws
  stage: dev
  iam: 
    role: arn:aws:iam::702954692849:role/awsnodetraining-dev-role
  runtime: nodejs16.x
  region: ap-southeast-1
  deploymentMethod: direct
  deploymentBucket:
    name: awsnodejstraining
    versioning: true
  deploymentPrefix: cris-jaddie-rodel
  endpointType: REGIONAL
  environment:
    tableName: ${self:custom.tableName}

custom:
  tableName: flexben-api-cjr

functions:
  Flexben:
    handler: index.api
    name: awsnodetraining-${sls:stage}-flexben-api-cjr
    description: Lambda Function for FlexBen API for AWS NodeJS Training by Cris, Jaddie, and Rodel
    events:
      - http:
          path: api/v1/
          method: any
      - http:
          path: api/v1/login
          method: post
      - http:
          path: api/v1/logout
          method: delete
      - http:
          path: api/v1/hr/reimbursement/
          method: get

resources:
  Resources:
    FlexbenTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: ${self:custom.tableName}
        AttributeDefinitions:
          - AttributeName: PK
            AttributeType: S
          - AttributeName: SK
            AttributeType: S
        KeySchema:
          - AttributeName: PK
            KeyType: HASH
          - AttributeName: SK
            KeyType: RANGE
        BillingMode: PAY_PER_REQUEST
